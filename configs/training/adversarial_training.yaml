stage2_start_step: 100000  # Set to positive value to enable stage 2, e.g., 100000
                      # Stage 1: Train full VAE
                      # Stage 2: Freeze encoder, train decoder only

loss:
  # Reconstruction losses
  use_ms_lr_loss: true  # Use Mid-Side + Left-Right weighted loss
  ms_weight: 1.0        # Weight for mid-side loss
  lr_weight: 0.5        # Weight for left-right loss (paper uses 0.5)
  waveform_weight: 0.1  # Additional L1 waveform loss weight
  
  # KL divergence (only in stage 1)
  kl_weight: 0.0001     # Paper uses 1e-4
  kl_warmup_steps: 5000
  free_bits: 0.0
  
  # Adversarial losses
  adv_weight: 1.0       # Adversarial loss weight
  fm_weight: 2.0        # Feature matching loss weight

optimizer:
  learning_rate: 15e-5     # Paper: 1.5e-4 for generator
  disc_learning_rate: 3e-4  # Paper: 3e-4 for discriminator
  betas: [0.8, 0.99]
  weight_decay: 0.01
  warmup_steps: 1000

trainer:
  max_epochs: 1000
  max_steps: -1  # -1 for unlimited
  devices: [3]
  strategy: "auto"  # Use "ddp" for multi-GPU
  precision: "16-mixed"
  gradient_clip_val: 1.0
  accumulate_grad_batches: 2
  log_every_n_steps: 50
  val_check_interval: 1.0

early_stopping:
  patience: 50
  min_delta: 0.0001

logging:
  log_audio_every_n_epochs: 5